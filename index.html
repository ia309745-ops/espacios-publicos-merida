<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Espacios Públicos de Mérida</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header id="main-header">
        <h1 id="header-title">Espacios Públicos en Mérida</h1>
        <nav class="tabs">
            <button class="tab-link" data-tab="modal-tab-info">Información</button>
            <button class="tab-link" data-tab="modal-tab-web">Sitios Web</button>
            <button class="tab-link" data-tab="modal-tab-calificar">Calificar Visor</button>
            <button class="tab-link" data-tab="modal-tab-contacto">Contacto</button> 
        </nav>
    </header>

    <div id="map"></div>

    <div id="left-info-panel">
        <div id="tab-content">
            <div id="tab-info" class="tab-pane active">
                <p id="info-default" style="display: block;">
                    <i class="fa-solid fa-arrow-pointer"></i> Selecciona un espacio en el mapa para ver su diagnóstico.
                </p>
                
                <div id="info-panel" style="display: none;">
                    <h3 id="dash-titulo"></h3>
                    <p id="dash-modulos"></p>
                    <p id="dash-nom"></p>
                    <p id="dash-area"></p>
                    
                    <div class="population-stats">
                        <h4>Población Beneficiada (Radio de Influencia)</h4>
                        <div class="pob-grid">
                            <div class="pob-item">
                                <i class="fa-solid fa-users"></i>
                                <span id="dash-pob-total">0</span>
                                <small>Total</small>
                            </div>
                            <div class="pob-item">
                                <i class="fa-solid fa-child"></i>
                                <span id="dash-pob-0-14">0</span>
                                <small>0-14 años</small>
                            </div>
                            <div class="pob-item">
                                <i class="fa-solid fa-person-walking-with-cane"></i>
                                <span id="dash-pob-65">0</span>
                                <small>65+ años</small>
                            </div>
                            <div class="pob-item">
                                <i class="fa-solid fa-wheelchair"></i>
                                <span id="dash-pob-disc">0</span>
                                <small>Discap.</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="right-controls-panel">
        <h3>Controles de Mapa</h3>
        
        <div id="filters-section">
            <h4><i class="fa-solid fa-filter"></i> Filtrar por Tipo</h4>
            <div id="category-filters">
                <small>Cargando...</small>
            </div>
        </div>

        <hr>

        <div class="control-group">
            <label for="opacity-slider"><i class="fa-solid fa-layer-group"></i> Opacidad:</label>
            <input type="range" id="opacity-slider" min="0" max="1" step="0.1" value="0.9">
        </div>

        <button id="btn-ubicacion" title="Encuéntrate">
            <i class="fa-solid fa-location-dot"></i> Mi Ubicación
        </button>

        <button id="btn-toggle-radii">
            <i class="fa-solid fa-circle-notch"></i> Ver Cobertura (Radios)
        </button>
    </div>

    <div id="bottom-legend">
        <div class="legend-item">
            <span class="legend-icon" style="background: linear-gradient(45deg, #238b45, #3498db, #f39c12); border: 1px solid white;"></span>
            Espacios Públicos (Por Categoría)
        </div>
        <div class="legend-item">
            <span class="legend-icon" style="border: 2px solid #333;"></span>
            Límite Municipal de Mérida
        </div>
        <div class="legend-item">
            <span class="legend-icon" style="border: 2px dashed rgba(255, 120, 0, 0.5);"></span>
            Límite de la Zona Metropolitana
        </div>
        <div class="legend-item">
            <span class="legend-icon" style="background: rgba(110, 190, 137, 0.2); border: 1px dashed #333; border-radius: 50%;"></span>
            Radio de Influencia
        </div>
        <div class="legend-item">
            <span class="legend-icon" style="background: rgba(179, 212, 190, 0.4); border: 1px solid #238b45;"></span>
            Manzanas beneficiadas
        </div>
    </div>

    <div id="global-dashboard">
        <h3>Diagnóstico Municipal</h3>
        <div class="stat-row">
            <span>Espacios Públicos:</span>
            <strong id="stat-total-ep">...</strong>
        </div>
        <div class="stat-row">
            <span>Superficie Total:</span>
            <strong id="stat-total-area">...</strong>
        </div>
        <div class="stat-row">
            <span>Población Total (INEGI):</span>
            <strong id="stat-pob-total">...</strong>
        </div>
        <div class="stat-row highlight">
            <span>Población Beneficiada:</span>
            <strong id="stat-pob-beneficiada">Calculando...</strong>
        </div>
    </div>

    <div id="modal-overlay">
        <div id="modal-container">
            <button id="modal-close-btn">×</button>
            <div id="modal-tab-info" class="modal-tab-pane">
                <h2>Información del Geovisualizador</h2>
                <h3>Objetivo</h3>
                <p>El objetivo del Geovisualizador es concentrar, procesar y visualizar datos geoespaciales sobre los espacios públicos, permitiendo identificar su distribución, tipología, estado físico, equipamiento y nivel de accesibilidad. Con esta plataforma se busca facilitar la toma de decisiones para autoridades, especialistas y ciudadanía, promoviendo la creación y mejoramiento de espacios públicos seguros, inclusivos, resilientes y socialmente cohesionados.</p>
                <h3>Relación con la NOM-001-SEDATU-2021</h3>
                <ul>
                    <li><b>Clasificación estandarizada:</b> La plataforma integra las categorías oficiales de la NOM (áreas verdes, plazas, infraestructuras peatonales, espacios naturales, equipamiento urbano, etc.), asegurando compatibilidad con los instrumentos de planeación urbana.</li>
                    <li><b>Autoevaluación municipal:</b> La NOM promueve que los gobiernos locales realicen autoevaluaciones periódicas. El Geovisualizador opera como una herramienta directa para cumplir este propósito, generando reportes, mapas temáticos y diagnósticos comparables.</li>
                </ul>
            </div>
            <div id="modal-tab-web" class="modal-tab-pane">
                <h2>Sitios Web de Interés</h2>
                <ul>
                    <li><a href="https://www.merida.gob.mx/" target="_blank">Ayuntamiento de Mérida</a></li>
                    <li><a href="https://www.anpr.org.mx/" target="_blank">ANPR</a></li>
                    <li><a href="https://www.gob.mx/sedatu" target="_blank">SEDATU</a></li>
                </ul>
            </div>
            <div id="modal-tab-calificar" class="modal-tab-pane">
                <h4>Califica este Geovisualizador</h4>
                <div class="rating-stars">
                    <i class="fa-solid fa-star" data-value="1"></i>
                    <i class="fa-solid fa-star" data-value="2"></i>
                    <i class="fa-solid fa-star" data-value="3"></i>
                    <i class="fa-solid fa-star" data-value="4"></i>
                    <i class="fa-solid fa-star" data-value="5"></i>
                </div>
                <textarea id="comment-box" rows="4" placeholder="Escribe tu comentario..."></textarea>
                <button id="submit-rating-btn">Enviar Opinión</button>
            </div>
            <div id="modal-tab-contacto" class="modal-tab-pane">
                <h2>Contacto</h2>
                <div class="contact-person">
                    <h3>Urbanista Frida Céspedes</h3>
                    <p>Correo: <a href="mailto:cespedes.frida01@gmail.com">cespedes.frida01@gmail.com</a></p>
                </div>
                <div class="contact-person">
                    <h3>Urbanista Ismael Luna</h3>
                    <p>Correo: <a href="mailto:ia309745@gmail.com">ia309745@gmail.com</a></p>
                </div>
                <div class="contact-affiliation">
                    <p>Universidad Nacional Autónoma de México (UNAM)</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/@turf/turf/turf.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
</body>
</html>